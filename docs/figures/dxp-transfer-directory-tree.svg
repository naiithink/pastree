<?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="3009px" preserveAspectRatio="none" style="width:1357px;height:3009px;background:#FFFFFF;" version="1.1" viewBox="0 0 1357 3009" width="1357px" zoomAndPan="magnify"><defs/><g><text fill="#000000" font-family="Courier" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="168" x="607.5" y="27.9951">TransferDirectoryTree</text><rect fill="#FFFFFF" height="2300.9063" style="stroke:#181818;stroke-width:1.5;" width="1309" x="42" y="52.2969"/><path d="M244,52.2969 L244,61.5938 L234,71.5938 L42,71.5938 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><text fill="#000000" font-family="Courier" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="16" x="45" y="66.292">sd</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="168" x="69" y="66.292">TransferDirectoryTree</text><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="166" x2="166" y1="111.8906" y2="2306.6094"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="161" y="1622.0156"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="326" x2="326" y1="111.8906" y2="2306.6094"/><rect fill="#FFFFFF" height="13" style="stroke:#181818;stroke-width:1.0;" width="10" x="321" y="482.4219"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="321" y="718.75"/><rect fill="#FFFFFF" height="13" style="stroke:#181818;stroke-width:1.0;" width="10" x="321" y="1028.75"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="321" y="1207.8125"/><rect fill="#FFFFFF" height="13" style="stroke:#181818;stroke-width:1.0;" width="10" x="321" y="1445.5469"/><rect fill="#FFFFFF" height="13" style="stroke:#181818;stroke-width:1.0;" width="10" x="321" y="1795.6797"/><rect fill="#FFFFFF" height="13" style="stroke:#181818;stroke-width:1.0;" width="10" x="321" y="2039.7422"/><rect fill="#FFFFFF" height="13" style="stroke:#181818;stroke-width:1.0;" width="10" x="321" y="2274.6094"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="684" x2="684" y1="111.8906" y2="2306.6094"/><rect fill="#FFFFFF" height="2181.7188" style="stroke:#181818;stroke-width:1.0;" width="10" x="679" y="119.8906"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="981" x2="981" y1="111.8906" y2="2306.6094"/><rect fill="#FFFFFF" height="1744.6563" style="stroke:#181818;stroke-width:1.0;" width="10" x="976" y="556.9531"/><rect fill="#E3E3E3" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="166" x="83" y="80.5938"/><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="152" x="90" y="100.5889">fs:SenderFilesystem</text><rect fill="#E3E3E3" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="134" x="259" y="80.5938"/><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="120" x="266" y="100.5889">bf:SenderBuffer</text><rect fill="#E3E3E3" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="86" x="641" y="80.5938"/><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="72" x="648" y="100.5889">ps:Sender</text><rect fill="#E3E3E3" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="110" x="926" y="80.5938"/><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="96" x="933" y="100.5889">ps:Recipient</text><rect fill="#E3E3E3" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="166" x="83" y="2306.6094"/><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="152" x="90" y="2326.6045">fs:SenderFilesystem</text><rect fill="#E3E3E3" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="134" x="259" y="2306.6094"/><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="120" x="266" y="2326.6045">bf:SenderBuffer</text><rect fill="#E3E3E3" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="86" x="641" y="2306.6094"/><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="72" x="648" y="2326.6045">ps:Sender</text><rect fill="#E3E3E3" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="110" x="926" y="2306.6094"/><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="96" x="933" y="2326.6045">ps:Recipient</text><path d="M649,123.8906 L718,123.8906 L718,131.0234 L708,141.0234 L649,141.0234 L649,123.8906 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="281.2656" style="stroke:#000000;stroke-width:1.5;" width="445" x="649" y="123.8906"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24" x="664" y="136.9575">opt</text><text fill="#000000" font-family="Courier" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="336" x="733" y="136.1011">[Recipient&#160;requests&#160;to&#160;receive&#160;a&#160;directory&#160;tree]</text><polygon fill="#181818" points="700,198.4219,690,202.4219,700,206.4219,696,202.4219" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="694" x2="980" y1="202.4219" y2="202.4219"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="706" y="182.2231">1</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="88" x="718" y="167.0903">PULL&#160;&lt;PATH&gt;</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="128" x="718" y="182.2231">Cookie:&#160;&lt;COOKIE&gt;</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="24" x="718" y="197.356">...</text><path d="M668,214.4219 L737,214.4219 L737,221.5547 L727,231.5547 L668,231.5547 L668,214.4219 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="176.7344" style="stroke:#000000;stroke-width:1.5;" width="401" x="668" y="214.4219"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24" x="683" y="227.4888">alt</text><text fill="#000000" font-family="Courier" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="301" x="752" y="226.6323">[Sender&#160;accepts&#160;to&#160;send&#160;the&#160;directory&#160;tree]</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="668" x2="1069" y1="311.9531" y2="311.9531"/><text fill="#000000" font-family="Courier" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="301" x="673" y="324.1636">[Sender&#160;refuses&#160;to&#160;send&#160;the&#160;directory&#160;tree]</text><line style="stroke:#181818;stroke-width:1.0;" x1="979" x2="969" y1="292.9531" y2="288.9531"/><line style="stroke:#181818;stroke-width:1.0;" x1="979" x2="969" y1="292.9531" y2="296.9531"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="689" x2="980" y1="292.9531" y2="292.9531"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="696" y="272.7544">2</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="104" x="708" y="257.6216">1000&#160;ACCEPTED</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="128" x="708" y="272.7544">Cookie:&#160;&lt;COOKIE&gt;</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="24" x="708" y="287.8872">...</text><line style="stroke:#181818;stroke-width:1.0;" x1="979" x2="969" y1="383.1563" y2="379.1563"/><line style="stroke:#181818;stroke-width:1.0;" x1="979" x2="969" y1="383.1563" y2="387.1563"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="689" x2="980" y1="383.1563" y2="383.1563"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="696" y="362.9575">3</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="104" x="708" y="347.8247">1001&#160;DECLINED</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="128" x="708" y="362.9575">Cookie:&#160;&lt;COOKIE&gt;</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="24" x="708" y="378.0903">...</text><line style="stroke:#181818;stroke-width:1.0;" x1="689" x2="731" y1="440.2891" y2="440.2891"/><line style="stroke:#181818;stroke-width:1.0;" x1="731" x2="731" y1="440.2891" y2="453.2891"/><line style="stroke:#181818;stroke-width:1.0;" x1="690" x2="731" y1="453.2891" y2="453.2891"/><polygon fill="#181818" points="700,449.2891,690,453.2891,700,457.2891,696,453.2891" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="696" y="435.2231">4</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="120" x="708" y="435.2231">Generate&#160;cookie</text><line style="stroke:#181818;stroke-width:1.0;" x1="332" x2="342" y1="482.4219" y2="478.4219"/><line style="stroke:#181818;stroke-width:1.0;" x1="332" x2="342" y1="482.4219" y2="486.4219"/><line style="stroke:#181818;stroke-width:1.0;" x1="331" x2="678" y1="482.4219" y2="482.4219"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="348" y="477.356">5</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="136" x="360" y="477.356">Put&#160;cookie&#160;record</text><polygon fill="#181818" points="964,552.9531,974,556.9531,964,560.9531,968,556.9531" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="689" x2="970" y1="556.9531" y2="556.9531"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="696" y="529.188">6</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="120" x="708" y="506.4888">PUSH&#160;&lt;DIR_NAME&gt;</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="128" x="708" y="521.6216">Cookie:&#160;&lt;COOKIE&gt;</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="256" x="708" y="536.7544">Cookie-Expire:&#160;&lt;EXPIRE_DATETIME&gt;</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="24" x="708" y="551.8872">...</text><line style="stroke:#181818;stroke-width:1.0;" x1="986" x2="1028" y1="586.0859" y2="586.0859"/><line style="stroke:#181818;stroke-width:1.0;" x1="1028" x2="1028" y1="586.0859" y2="599.0859"/><line style="stroke:#181818;stroke-width:1.0;" x1="987" x2="1028" y1="599.0859" y2="599.0859"/><polygon fill="#181818" points="997,595.0859,987,599.0859,997,603.0859,993,599.0859" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="993" y="581.02">7</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="120" x="1005" y="581.02">Remember&#160;cookie</text><path d="M48,611.0859 L117,611.0859 L117,618.2188 L107,628.2188 L48,628.2188 L48,611.0859 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="1671.5234" style="stroke:#000000;stroke-width:1.5;" width="1286" x="48" y="611.0859"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24" x="63" y="624.1528">alt</text><text fill="#000000" font-family="Courier" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="343" x="132" y="623.2964">[Recipient&#160;accepts&#160;to&#160;receive&#160;the&#160;directory&#160;tree]</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="48" x2="1334" y1="2174.2734" y2="2174.2734"/><text fill="#000000" font-family="Courier" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="343" x="53" y="2186.4839">[Recipient&#160;refuses&#160;to&#160;receive&#160;the&#160;directory&#160;tree]</text><line style="stroke:#181818;stroke-width:1.0;" x1="690" x2="700" y1="689.6172" y2="685.6172"/><line style="stroke:#181818;stroke-width:1.0;" x1="690" x2="700" y1="689.6172" y2="693.6172"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="689" x2="975" y1="689.6172" y2="689.6172"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="706" y="669.4185">8</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="104" x="718" y="654.2856">1000&#160;ACCEPTED</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="128" x="718" y="669.4185">Cookie:&#160;&lt;COOKIE&gt;</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="24" x="718" y="684.5513">...</text><polygon fill="#181818" points="342,714.75,332,718.75,342,722.75,338,718.75" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="336" x2="678" y1="718.75" y2="718.75"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="348" y="713.6841">9</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="136" x="360" y="713.6841">Get&#160;cookie&#160;record</text><line style="stroke:#181818;stroke-width:1.0;" x1="677" x2="667" y1="747.8828" y2="743.8828"/><line style="stroke:#181818;stroke-width:1.0;" x1="677" x2="667" y1="747.8828" y2="751.8828"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="331" x2="678" y1="747.8828" y2="747.8828"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="338" y="742.8169">10</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="104" x="358" y="742.8169">Cookie&#160;record</text><line style="stroke:#181818;stroke-width:1.0;" x1="689" x2="731" y1="777.0156" y2="777.0156"/><line style="stroke:#181818;stroke-width:1.0;" x1="731" x2="731" y1="777.0156" y2="790.0156"/><line style="stroke:#181818;stroke-width:1.0;" x1="690" x2="731" y1="790.0156" y2="790.0156"/><polygon fill="#181818" points="700,786.0156,690,790.0156,700,794.0156,696,790.0156" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="696" y="771.9497">11</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="152" x="716" y="771.9497">Check&#160;cookie&#160;expiry</text><path d="M649,802.0156 L734,802.0156 L734,809.1484 L724,819.1484 L649,819.1484 L649,802.0156 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="191.6016" style="stroke:#000000;stroke-width:1.5;" width="373" x="649" y="802.0156"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="40" x="664" y="815.0825">break</text><text fill="#000000" font-family="Courier" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="105" x="749" y="814.2261">[Faulty&#160;cookie]</text><path d="M668,833.1484 L737,833.1484 L737,840.2813 L727,850.2813 L668,850.2813 L668,833.1484 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="146.4688" style="stroke:#000000;stroke-width:1.5;" width="329" x="668" y="833.1484"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24" x="683" y="846.2153">alt</text><text fill="#000000" font-family="Courier" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="140" x="752" y="845.3589">[Cookie&#160;has&#160;expired]</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="668" x2="997" y1="915.5469" y2="915.5469"/><text fill="#000000" font-family="Courier" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="161" x="673" y="927.7573">[Cookie&#160;does&#160;not&#160;exist]</text><line style="stroke:#181818;stroke-width:1.0;" x1="974" x2="964" y1="896.5469" y2="892.5469"/><line style="stroke:#181818;stroke-width:1.0;" x1="974" x2="964" y1="896.5469" y2="900.5469"/><line style="stroke:#181818;stroke-width:1.0;" x1="689" x2="975" y1="896.5469" y2="896.5469"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="696" y="883.9146">12</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="152" x="716" y="876.3481">1002&#160;COOKIE&#160;EXPIRED</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="24" x="716" y="891.481">...</text><line style="stroke:#181818;stroke-width:1.0;" x1="974" x2="964" y1="971.6172" y2="967.6172"/><line style="stroke:#181818;stroke-width:1.0;" x1="974" x2="964" y1="971.6172" y2="975.6172"/><line style="stroke:#181818;stroke-width:1.0;" x1="689" x2="975" y1="971.6172" y2="971.6172"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="696" y="958.9849">13</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="80" x="716" y="951.4185">74&#160;EBADMSG</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="24" x="716" y="966.5513">...</text><line style="stroke:#181818;stroke-width:1.0;" x1="332" x2="342" y1="1028.75" y2="1024.75"/><line style="stroke:#181818;stroke-width:1.0;" x1="332" x2="342" y1="1028.75" y2="1032.75"/><line style="stroke:#181818;stroke-width:1.0;" x1="331" x2="678" y1="1028.75" y2="1028.75"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="348" y="1023.6841">14</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="216" x="368" y="1023.6841">Mark&#160;cookie&#160;record&#160;as&#160;valid</text><line style="stroke:#181818;stroke-width:1.0;" x1="974" x2="964" y1="1088.1484" y2="1084.1484"/><line style="stroke:#181818;stroke-width:1.0;" x1="974" x2="964" y1="1088.1484" y2="1092.1484"/><line style="stroke:#181818;stroke-width:1.0;" x1="689" x2="975" y1="1088.1484" y2="1088.1484"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="696" y="1067.9497">15</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="32" x="716" y="1052.8169">POLL</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="128" x="716" y="1067.9497">Cookie:&#160;&lt;COOKIE&gt;</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="24" x="716" y="1083.0825">...</text><path d="M67,1100.1484 L144,1100.1484 L144,1107.2813 L134,1117.2813 L67,1117.2813 L67,1100.1484 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="1049.125" style="stroke:#000000;stroke-width:1.5;" width="1242" x="67" y="1100.1484"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32" x="82" y="1113.2153">loop</text><polygon fill="#181818" points="700,1174.6797,690,1178.6797,700,1182.6797,696,1178.6797" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="694" x2="975" y1="1178.6797" y2="1178.6797"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="706" y="1158.481">16</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="104" x="726" y="1143.3481">PICK&#160;&lt;COOKIE&gt;</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="128" x="726" y="1158.481">Cookie:&#160;&lt;COOKIE&gt;</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="24" x="726" y="1173.6138">...</text><polygon fill="#181818" points="342,1203.8125,332,1207.8125,342,1211.8125,338,1207.8125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="336" x2="678" y1="1207.8125" y2="1207.8125"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="348" y="1202.7466">17</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="136" x="368" y="1202.7466">Get&#160;cookie&#160;record</text><line style="stroke:#181818;stroke-width:1.0;" x1="677" x2="667" y1="1236.9453" y2="1232.9453"/><line style="stroke:#181818;stroke-width:1.0;" x1="677" x2="667" y1="1236.9453" y2="1240.9453"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="331" x2="678" y1="1236.9453" y2="1236.9453"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="338" y="1231.8794">18</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="104" x="358" y="1231.8794">Cookie&#160;record</text><line style="stroke:#181818;stroke-width:1.0;" x1="689" x2="731" y1="1266.0781" y2="1266.0781"/><line style="stroke:#181818;stroke-width:1.0;" x1="731" x2="731" y1="1266.0781" y2="1279.0781"/><line style="stroke:#181818;stroke-width:1.0;" x1="690" x2="731" y1="1279.0781" y2="1279.0781"/><polygon fill="#181818" points="700,1275.0781,690,1279.0781,700,1283.0781,696,1279.0781" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="696" y="1261.0122">19</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="256" x="716" y="1261.0122">Check&#160;cookie&#160;expiry&#160;and&#160;validity</text><path d="M224,1291.0781 L309,1291.0781 L309,1298.2109 L299,1308.2109 L224,1308.2109 L224,1291.0781 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="295.8047" style="stroke:#000000;stroke-width:1.5;" width="798" x="224" y="1291.0781"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="40" x="239" y="1304.145">break</text><text fill="#000000" font-family="Courier" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="105" x="324" y="1303.2886">[Faulty&#160;cookie]</text><path d="M243,1322.2109 L312,1322.2109 L312,1329.3438 L302,1339.3438 L243,1339.3438 L243,1322.2109 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="250.6719" style="stroke:#000000;stroke-width:1.5;" width="754" x="243" y="1322.2109"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24" x="258" y="1335.2778">alt</text><text fill="#000000" font-family="Courier" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="140" x="327" y="1334.4214">[Cookie&#160;has&#160;expired]</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="243" x2="997" y1="1404.6094" y2="1404.6094"/><text fill="#000000" font-family="Courier" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="133" x="248" y="1416.8198">[Cookie&#160;is&#160;invalid]</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="243" x2="997" y1="1508.8125" y2="1508.8125"/><text fill="#000000" font-family="Courier" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="161" x="248" y="1521.0229">[Cookie&#160;does&#160;not&#160;exist]</text><line style="stroke:#181818;stroke-width:1.0;" x1="974" x2="964" y1="1385.6094" y2="1381.6094"/><line style="stroke:#181818;stroke-width:1.0;" x1="974" x2="964" y1="1385.6094" y2="1389.6094"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="689" x2="975" y1="1385.6094" y2="1385.6094"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="696" y="1372.9771">20</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="152" x="716" y="1365.4106">1002&#160;COOKIE&#160;EXPIRED</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="24" x="716" y="1380.5435">...</text><line style="stroke:#181818;stroke-width:1.0;" x1="332" x2="342" y1="1445.5469" y2="1441.5469"/><line style="stroke:#181818;stroke-width:1.0;" x1="332" x2="342" y1="1445.5469" y2="1449.5469"/><line style="stroke:#181818;stroke-width:1.0;" x1="331" x2="678" y1="1445.5469" y2="1445.5469"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="348" y="1440.481">21</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="224" x="368" y="1440.481">Expire&#160;out&#160;the&#160;cookie&#160;record</text><line style="stroke:#181818;stroke-width:1.0;" x1="974" x2="964" y1="1489.8125" y2="1485.8125"/><line style="stroke:#181818;stroke-width:1.0;" x1="974" x2="964" y1="1489.8125" y2="1493.8125"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="689" x2="975" y1="1489.8125" y2="1489.8125"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="696" y="1477.1802">22</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="80" x="716" y="1469.6138">74&#160;EBADMSG</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="24" x="716" y="1484.7466">...</text><line style="stroke:#181818;stroke-width:1.0;" x1="974" x2="964" y1="1564.8828" y2="1560.8828"/><line style="stroke:#181818;stroke-width:1.0;" x1="974" x2="964" y1="1564.8828" y2="1568.8828"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="689" x2="975" y1="1564.8828" y2="1564.8828"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="696" y="1552.2505">23</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="80" x="716" y="1544.6841">74&#160;EBADMSG</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="24" x="716" y="1559.8169">...</text><polygon fill="#181818" points="182,1618.0156,172,1622.0156,182,1626.0156,178,1622.0156" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="176" x2="678" y1="1622.0156" y2="1622.0156"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="188" y="1616.9497">24</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="336" x="208" y="1616.9497">Get&#160;node&#160;contents&#160;at&#160;path&#160;in&#160;cookie&#160;record</text><line style="stroke:#181818;stroke-width:1.0;" x1="677" x2="667" y1="1651.1484" y2="1647.1484"/><line style="stroke:#181818;stroke-width:1.0;" x1="677" x2="667" y1="1651.1484" y2="1655.1484"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="171" x2="678" y1="1651.1484" y2="1651.1484"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="178" y="1646.0825">25</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="104" x="198" y="1646.0825">Node&#160;contents</text><line style="stroke:#181818;stroke-width:1.0;" x1="689" x2="731" y1="1680.2813" y2="1680.2813"/><line style="stroke:#181818;stroke-width:1.0;" x1="731" x2="731" y1="1680.2813" y2="1693.2813"/><line style="stroke:#181818;stroke-width:1.0;" x1="690" x2="731" y1="1693.2813" y2="1693.2813"/><polygon fill="#181818" points="700,1689.2813,690,1693.2813,700,1697.2813,696,1693.2813" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="696" y="1675.2153">26</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="152" x="716" y="1675.2153">Determine&#160;next&#160;path</text><line style="stroke:#181818;stroke-width:1.0;" x1="689" x2="731" y1="1722.4141" y2="1722.4141"/><line style="stroke:#181818;stroke-width:1.0;" x1="731" x2="731" y1="1722.4141" y2="1735.4141"/><line style="stroke:#181818;stroke-width:1.0;" x1="690" x2="731" y1="1735.4141" y2="1735.4141"/><polygon fill="#181818" points="700,1731.4141,690,1735.4141,700,1739.4141,696,1735.4141" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="696" y="1717.3481">27</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="176" x="716" y="1717.3481">Calculate&#160;Eng&#160;checksum</text><path d="M243,1747.4141 L328,1747.4141 L328,1754.5469 L318,1764.5469 L243,1764.5469 L243,1747.4141 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="257.1953" style="stroke:#000000;stroke-width:1.5;" width="1041" x="243" y="1747.4141"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="40" x="258" y="1760.481">break</text><text fill="#000000" font-family="Courier" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="105" x="343" y="1759.6245">[No&#160;nodes&#160;left]</text><line style="stroke:#181818;stroke-width:1.0;" x1="332" x2="342" y1="1795.6797" y2="1791.6797"/><line style="stroke:#181818;stroke-width:1.0;" x1="332" x2="342" y1="1795.6797" y2="1799.6797"/><line style="stroke:#181818;stroke-width:1.0;" x1="331" x2="678" y1="1795.6797" y2="1795.6797"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="348" y="1790.6138">28</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="224" x="368" y="1790.6138">Expire&#160;out&#160;the&#160;cookie&#160;record</text><line style="stroke:#181818;stroke-width:1.0;" x1="974" x2="964" y1="1870.2109" y2="1866.2109"/><line style="stroke:#181818;stroke-width:1.0;" x1="974" x2="964" y1="1870.2109" y2="1874.2109"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="689" x2="975" y1="1870.2109" y2="1870.2109"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="696" y="1842.4458">29</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="716" y="1819.7466">2000&#160;DONE</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="128" x="716" y="1834.8794">Cookie:&#160;&lt;COOKIE&gt;</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="160" x="716" y="1850.0122">Digest:&#160;&lt;ENG_DIGEST&gt;</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="24" x="716" y="1865.145">...</text><line style="stroke:#181818;stroke-width:1.0;" x1="986" x2="1028" y1="1899.3438" y2="1899.3438"/><line style="stroke:#181818;stroke-width:1.0;" x1="1028" x2="1028" y1="1899.3438" y2="1912.3438"/><line style="stroke:#181818;stroke-width:1.0;" x1="987" x2="1028" y1="1912.3438" y2="1912.3438"/><polygon fill="#181818" points="997,1908.3438,987,1912.3438,997,1916.3438,993,1912.3438" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="993" y="1894.2778">30</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="104" x="1013" y="1894.2778">Forget&#160;cookie</text><line style="stroke:#181818;stroke-width:1.0;" x1="986" x2="1028" y1="1941.4766" y2="1941.4766"/><line style="stroke:#181818;stroke-width:1.0;" x1="1028" x2="1028" y1="1941.4766" y2="1954.4766"/><line style="stroke:#181818;stroke-width:1.0;" x1="987" x2="1028" y1="1954.4766" y2="1954.4766"/><polygon fill="#181818" points="997,1950.4766,987,1954.4766,997,1958.4766,993,1954.4766" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="993" y="1936.4106">31</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="192" x="1013" y="1936.4106">Calculate&#160;Chang&#160;checksum</text><line style="stroke:#181818;stroke-width:1.0;" x1="986" x2="1028" y1="1983.6094" y2="1983.6094"/><line style="stroke:#181818;stroke-width:1.0;" x1="1028" x2="1028" y1="1983.6094" y2="1996.6094"/><line style="stroke:#181818;stroke-width:1.0;" x1="987" x2="1028" y1="1996.6094" y2="1996.6094"/><polygon fill="#181818" points="997,1992.6094,987,1996.6094,997,2000.6094,993,1996.6094" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="993" y="1978.5435">32</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="248" x="1013" y="1978.5435">Compare&#160;Eng&#160;with&#160;Chang&#160;checksum</text><line style="stroke:#181818;stroke-width:1.0;" x1="332" x2="342" y1="2039.7422" y2="2035.7422"/><line style="stroke:#181818;stroke-width:1.0;" x1="332" x2="342" y1="2039.7422" y2="2043.7422"/><line style="stroke:#181818;stroke-width:1.0;" x1="331" x2="678" y1="2039.7422" y2="2039.7422"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="348" y="2034.6763">33</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="304" x="368" y="2034.6763">Update&#160;cookie&#160;record's&#160;next&#160;path&#160;field</text><line style="stroke:#181818;stroke-width:1.0;" x1="974" x2="964" y1="2099.1406" y2="2095.1406"/><line style="stroke:#181818;stroke-width:1.0;" x1="974" x2="964" y1="2099.1406" y2="2103.1406"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="689" x2="975" y1="2099.1406" y2="2099.1406"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="696" y="2078.9419">34</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="716" y="2063.8091">2001&#160;MORE</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="128" x="716" y="2078.9419">Cookie:&#160;&lt;COOKIE&gt;</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="24" x="716" y="2094.0747">...</text><line style="stroke:#181818;stroke-width:1.0;" x1="986" x2="1028" y1="2128.2734" y2="2128.2734"/><line style="stroke:#181818;stroke-width:1.0;" x1="1028" x2="1028" y1="2128.2734" y2="2141.2734"/><line style="stroke:#181818;stroke-width:1.0;" x1="987" x2="1028" y1="2141.2734" y2="2141.2734"/><polygon fill="#181818" points="997,2137.2734,987,2141.2734,997,2145.2734,993,2141.2734" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="993" y="2123.2075">35</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="192" x="1013" y="2123.2075">Calculate&#160;Chang&#160;checksum</text><line style="stroke:#181818;stroke-width:1.0;" x1="690" x2="700" y1="2245.4766" y2="2241.4766"/><line style="stroke:#181818;stroke-width:1.0;" x1="690" x2="700" y1="2245.4766" y2="2249.4766"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="689" x2="975" y1="2245.4766" y2="2245.4766"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="706" y="2225.2778">36</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="104" x="726" y="2210.145">1001&#160;DECLINED</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="128" x="726" y="2225.2778">Cookie:&#160;&lt;COOKIE&gt;</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="24" x="726" y="2240.4106">...</text><line style="stroke:#181818;stroke-width:1.0;" x1="332" x2="342" y1="2274.6094" y2="2270.6094"/><line style="stroke:#181818;stroke-width:1.0;" x1="332" x2="342" y1="2274.6094" y2="2278.6094"/><line style="stroke:#181818;stroke-width:1.0;" x1="331" x2="678" y1="2274.6094" y2="2274.6094"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="348" y="2269.5435">37</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="224" x="368" y="2269.5435">Expire&#160;out&#160;the&#160;cookie&#160;record</text><rect fill="#DDDDDD" height="629.2813" id="_legend" rx="7.5" ry="7.5" style="stroke:#000000;stroke-width:1.0;" width="538" x="55" y="2359.9063"/><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="480" x="60" y="2377.9014">1.&#160;&#160;Request&#160;to&#160;receive&#160;a&#160;directory&#160;tree&#160;rooted&#160;at&#160;&lt;DIR_NAME&gt;</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="432" x="60" y="2394.1982">2.&#160;&#160;Refuse&#160;to&#160;send&#160;the&#160;directory&#160;tree&#160;rooted&#160;at&#160;&lt;PATH&gt;</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="224" x="60" y="2410.4951">4.&#160;&#160;INSERT&#160;INTO&#160;cookie_table</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="328" x="124" y="2426.792">(id,&#160;expire_at,&#160;is_valid,&#160;next_path,&#160;...)</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="464" x="124" y="2443.0889">VALUES&#160;(&lt;COOKIE&gt;,&#160;&lt;EXPIRE_DATETIME&gt;,&#160;0,&#160;&lt;NEXT_PATH&gt;,&#160;...);</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="456" x="60" y="2459.3857">5.&#160;&#160;Request&#160;to&#160;send&#160;a&#160;directory&#160;tree&#160;rooted&#160;at&#160;&lt;DIR_NAME&gt;</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="320" x="60" y="2475.6826">7.&#160;&#160;Accept&#160;to&#160;receive&#160;the&#160;directory&#160;tree</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="160" x="60" y="2491.9795">8.&#160;&#160;SELECT&#160;expire_at</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="136" x="124" y="2508.2764">FROM&#160;cookie_table</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="160" x="124" y="2524.5732">WHERE&#160;id&#160;=&#160;&lt;COOKIE&gt;;</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="384" x="60" y="2540.8701">11.&#160;Tell&#160;that&#160;the&#160;cookie&#160;in&#160;request&#160;has&#160;expired.</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="288" x="60" y="2557.167">12.&#160;Tell&#160;that&#160;the&#160;request&#160;is&#160;faulty.</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="184" x="60" y="2573.4639">13.&#160;UPDATE&#160;cookie_table</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="128" x="124" y="2589.7607">SET&#160;is_valid&#160;=&#160;1</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="160" x="124" y="2606.0576">WHERE&#160;id&#160;=&#160;&lt;COOKIE&gt;;</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="496" x="60" y="2622.3545">14.&#160;Tell&#160;"you&#160;may&#160;request&#160;back&#160;to&#160;get&#160;the&#160;next&#160;available&#160;node"</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="136" x="60" y="2638.6514">15.&#160;Get&#160;next&#160;node</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="328" x="60" y="2654.9482">16.&#160;SELECT&#160;expire_at,&#160;is_valid,&#160;next_path</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="136" x="124" y="2671.2451">FROM&#160;cookie_table</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="160" x="124" y="2687.542">WHERE&#160;id&#160;=&#160;&lt;COOKIE&gt;;</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="384" x="60" y="2703.8389">19.&#160;Tell&#160;that&#160;the&#160;cookie&#160;in&#160;request&#160;has&#160;expired.</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="184" x="60" y="2720.1357">20.&#160;UPDATE&#160;cookie_table</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="288" x="124" y="2736.4326">SET&#160;expire_at&#160;=&#160;&lt;(current&#160;datetime)&gt;</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="160" x="124" y="2752.7295">WHERE&#160;id&#160;=&#160;&lt;COOKIE&gt;;</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="288" x="60" y="2769.0264">21.&#160;Tell&#160;that&#160;the&#160;request&#160;is&#160;faulty.</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="288" x="60" y="2785.3232">22.&#160;Tell&#160;that&#160;the&#160;request&#160;is&#160;faulty.</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="184" x="60" y="2801.6201">27.&#160;UPDATE&#160;cookie_table</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="288" x="124" y="2817.917">SET&#160;expire_at&#160;=&#160;&lt;(current&#160;datetime)&gt;</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="160" x="124" y="2834.2139">WHERE&#160;id&#160;=&#160;&lt;COOKIE&gt;;</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="520" x="60" y="2850.5107">28.&#160;Send&#160;node&#160;and&#160;Eng&#160;checksum,&#160;and&#160;tell&#160;"this&#160;is&#160;the&#160;last&#160;node."</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="184" x="60" y="2866.8076">32.&#160;UPDATE&#160;cookie_table</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="216" x="124" y="2883.1045">SET&#160;next_path&#160;=&#160;&lt;NEXT_PATH&gt;</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="160" x="124" y="2899.4014">WHERE&#160;id&#160;=&#160;&lt;COOKIE&gt;;</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="456" x="60" y="2915.6982">33.&#160;Send&#160;node&#160;and&#160;tell&#160;"there&#160;is&#160;at&#160;least&#160;one&#160;node&#160;left."</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="320" x="60" y="2931.9951">35.&#160;Refuse&#160;to&#160;receive&#160;the&#160;directory&#160;tree</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="184" x="60" y="2948.292">36.&#160;UPDATE&#160;cookie_table</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="288" x="124" y="2964.5889">SET&#160;expire_at&#160;=&#160;&lt;(current&#160;datetime)&gt;</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="160" x="124" y="2980.8857">WHERE&#160;id&#160;=&#160;&lt;COOKIE&gt;;</text><!--SRC=[rLTjJzj84Fw-lsAEBr044Gwqt54kKfeu43KaA35t_L0fMkm9MM5xKtlDbVlrDxj-pni17ITTLP5aFRFpx3FFp8v_MKJy8U2WKFuDAagGnOyYNF281n38KBhpI0Qu_CJ36KzyrPEX6d9wt959931YJ0db8pWH3-CPHbqHeQjazEn4Y2pW8fn5slpmCFOE3pUOCGgXX2iMF5ImDuil9XXw6FM4Z_5ph33O0nv3jZYfMz_FCkiloOmshbX-wTKj5_c-5PiLYp7I3u6XCaR5BxOFonYBPqimo_K9OpnHCao2UqsKZmyK4-wbKZ807sUAMGqW-ny9nWgK1E84nHC21o_dXzA0296K2ZtW2Ywx_V5qsBwnMwnfd6T9ZDetrdkhEMvnlMqxrorsHcxzuSGUE_JXZC2Lyb7WLF5x7nba_mw4TmJuSq5xJRaw0X5FdxYl5qFygQOBhkP7q6WqFXGUVxG7T_O43Yuxez7NljqwWalxssr_R4-xRSTs-ZTwwOHMX_OtPsgWf3jyPX_hB9YJx4R1ENcsNHSNDVfMMM2_ak747jWTfpnL0Rqt7jsif-7FQtjiW_3WTyZFzPbPb3K7VP_Y41eTBFK54HA4z1Xp4a8Qo6imgxdia9k964nLFPFHQGFkRZLNww5CRAV80i6nNi1ubeNSUvO91Fov27dFtKTDrWEcK7G-WJznuUjm44eFzvX5ARaY0_DGBp7hKsE5mBMoU3EhlxsIrUR9ouGLK7Me0pU98gfByBX29GByqDeEgMdjaBVcBibjdhyxLbAuRcacMy3fYnq-W3j7zp5EWYEpeemWr9o0qNyDrUTncj_67ZjjleonoBAENHRoTcYdfylGSY0OeKP2H_PH8v5XAa3J73Kaac7PuRQKz-cdz-QNyAVzctgwgyGJkULN2DqDaXhG2TD_Y-wVoo3UrjWPA-sFMzc65t1xDnXaxVfxs347kYYmV0-fQnP1WViwjFwRUWCt_J3USYSmbfaU7xTQ9U8Bi4vEJg3TwTYtZjtTCJBwSSu47LFdwgsXBUZQdK5_k7jedOsSVFCZtxoayWf3Z7IoKbrKJ5h5c4249oflDuHMHjvoaccMy71rhHAmSfRRkybrvPPQTvfqvTWschnOlIgpynOHoq6ahfXAr346g0UDugJx5MsKJXLvR2ceQfIIgbqLifm6JR6-JbwYEFzIZzcfURsGXi99Txuye2dzPyt8VOJyaJX9FtkcFLS8onvNYCk2LswUceJg2cv2oWEawUncT9WIoJRo9DL7A1Nj9cArQIyuFmFxIxjxCxagb5_7bca_FqzT_LNURtZqM2TU3wdcrdwroEig7mq6MmhLbt91mFJ7fYxNxtnTAOd_YPRCDMP85AeYB6kxiAmTXVKcPUbRFKppkbu9QRC1cTJ6gxVrkoM4AtBTHV8xQzvQftbhVSVlJL9vc372fPTLsjjC66PgeLbowx7fbIt_KjVDiBhTAZNwLMzLDrrK60KYp8PiCnslKHVttSJNUrKdjlAWpKnJGsaE5QTlZlzvYfkwytT7GtjTfNR50uqw-XuRNasx_IjxucJrk-cswideeQZYZLObDvqvhxApqK46z9wUKlcNe8ml-LLOtTmoxnPUEJ5axEt7PH9X9j3_5_Yqu6OqjZTrlbTpKZRTh50g0rfrB2rcjBVT_pkCQU-cpVrQ8rX_BtsaDj8P3OTZcwR-5D0-R2BJCGLAGLWrO3bjhQ3u1m00]--></g></svg>