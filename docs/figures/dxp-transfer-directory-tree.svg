<?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="2888px" preserveAspectRatio="none" style="width:1357px;height:2888px;background:#FFFFFF;" version="1.1" viewBox="0 0 1357 2888" width="1357px" zoomAndPan="magnify"><defs/><g><text fill="#000000" font-family="Courier" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="168" x="607.5" y="27.9951">TransferDirectoryTree</text><rect fill="#FFFFFF" height="2180.4375" style="stroke:#181818;stroke-width:1.5;" width="1309" x="42" y="52.2969"/><path d="M244,52.2969 L244,61.5938 L234,71.5938 L42,71.5938 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><text fill="#000000" font-family="Courier" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="16" x="45" y="66.292">sd</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="168" x="69" y="66.292">TransferDirectoryTree</text><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="166" x2="166" y1="111.8906" y2="2186.1406"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="161" y="1501.5469"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="326" x2="326" y1="111.8906" y2="2186.1406"/><rect fill="#FFFFFF" height="13" style="stroke:#181818;stroke-width:1.0;" width="10" x="321" y="361.9531"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="321" y="598.2813"/><rect fill="#FFFFFF" height="13" style="stroke:#181818;stroke-width:1.0;" width="10" x="321" y="908.2813"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="321" y="1087.3438"/><rect fill="#FFFFFF" height="13" style="stroke:#181818;stroke-width:1.0;" width="10" x="321" y="1325.0781"/><rect fill="#FFFFFF" height="13" style="stroke:#181818;stroke-width:1.0;" width="10" x="321" y="1675.2109"/><rect fill="#FFFFFF" height="13" style="stroke:#181818;stroke-width:1.0;" width="10" x="321" y="1919.2734"/><rect fill="#FFFFFF" height="13" style="stroke:#181818;stroke-width:1.0;" width="10" x="321" y="2154.1406"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="684" x2="684" y1="111.8906" y2="2186.1406"/><rect fill="#FFFFFF" height="2061.25" style="stroke:#181818;stroke-width:1.0;" width="10" x="679" y="119.8906"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="981" x2="981" y1="111.8906" y2="2186.1406"/><rect fill="#FFFFFF" height="1744.6563" style="stroke:#181818;stroke-width:1.0;" width="10" x="976" y="436.4844"/><rect fill="#E3E3E3" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="166" x="83" y="80.5938"/><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="152" x="90" y="100.5889">fs:SenderFilesystem</text><rect fill="#E3E3E3" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="134" x="259" y="80.5938"/><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="120" x="266" y="100.5889">bf:SenderBuffer</text><rect fill="#E3E3E3" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="86" x="641" y="80.5938"/><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="72" x="648" y="100.5889">ps:Sender</text><rect fill="#E3E3E3" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="110" x="926" y="80.5938"/><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="96" x="933" y="100.5889">ps:Recipient</text><rect fill="#E3E3E3" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="166" x="83" y="2186.1406"/><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="152" x="90" y="2206.1357">fs:SenderFilesystem</text><rect fill="#E3E3E3" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="134" x="259" y="2186.1406"/><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="120" x="266" y="2206.1357">bf:SenderBuffer</text><rect fill="#E3E3E3" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="86" x="641" y="2186.1406"/><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="72" x="648" y="2206.1357">ps:Sender</text><rect fill="#E3E3E3" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="110" x="926" y="2186.1406"/><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="96" x="933" y="2206.1357">ps:Recipient</text><path d="M649,123.8906 L718,123.8906 L718,131.0234 L708,141.0234 L649,141.0234 L649,123.8906 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="160.7969" style="stroke:#000000;stroke-width:1.5;" width="461" x="649" y="123.8906"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24" x="664" y="136.9575">opt</text><text fill="#000000" font-family="Courier" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="336" x="733" y="136.1011">[Recipient&#160;requests&#160;to&#160;receive&#160;a&#160;directory&#160;tree]</text><polygon fill="#181818" points="700,183.2891,690,187.2891,700,191.2891,696,187.2891" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="694" x2="980" y1="187.2891" y2="187.2891"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="706" y="174.6567">1</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="88" x="718" y="167.0903">PULL&#160;&lt;PATH&gt;</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="24" x="718" y="182.2231">...</text><path d="M668,199.2891 L753,199.2891 L753,206.4219 L743,216.4219 L668,216.4219 L668,199.2891 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="71.3984" style="stroke:#000000;stroke-width:1.5;" width="417" x="668" y="199.2891"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="40" x="683" y="212.356">break</text><text fill="#000000" font-family="Courier" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="301" x="768" y="211.4995">[Sender&#160;refuses&#160;to&#160;send&#160;the&#160;directory&#160;tree]</text><line style="stroke:#181818;stroke-width:1.0;" x1="979" x2="969" y1="262.6875" y2="258.6875"/><line style="stroke:#181818;stroke-width:1.0;" x1="979" x2="969" y1="262.6875" y2="266.6875"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="689" x2="980" y1="262.6875" y2="262.6875"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="696" y="250.0552">2</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="104" x="708" y="242.4888">1001&#160;DECLINED</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="24" x="708" y="257.6216">...</text><line style="stroke:#181818;stroke-width:1.0;" x1="689" x2="731" y1="319.8203" y2="319.8203"/><line style="stroke:#181818;stroke-width:1.0;" x1="731" x2="731" y1="319.8203" y2="332.8203"/><line style="stroke:#181818;stroke-width:1.0;" x1="690" x2="731" y1="332.8203" y2="332.8203"/><polygon fill="#181818" points="700,328.8203,690,332.8203,700,336.8203,696,332.8203" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="696" y="314.7544">3</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="120" x="708" y="314.7544">Generate&#160;cookie</text><line style="stroke:#181818;stroke-width:1.0;" x1="332" x2="342" y1="361.9531" y2="357.9531"/><line style="stroke:#181818;stroke-width:1.0;" x1="332" x2="342" y1="361.9531" y2="365.9531"/><line style="stroke:#181818;stroke-width:1.0;" x1="331" x2="678" y1="361.9531" y2="361.9531"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="348" y="356.8872">4</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="136" x="360" y="356.8872">Put&#160;cookie&#160;record</text><polygon fill="#181818" points="964,432.4844,974,436.4844,964,440.4844,968,436.4844" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="689" x2="970" y1="436.4844" y2="436.4844"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="696" y="408.7192">5</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="120" x="708" y="386.02">PUSH&#160;&lt;DIR_NAME&gt;</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="128" x="708" y="401.1528">Cookie:&#160;&lt;COOKIE&gt;</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="256" x="708" y="416.2856">Cookie-Expire:&#160;&lt;EXPIRE_DATETIME&gt;</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="24" x="708" y="431.4185">...</text><line style="stroke:#181818;stroke-width:1.0;" x1="986" x2="1028" y1="465.6172" y2="465.6172"/><line style="stroke:#181818;stroke-width:1.0;" x1="1028" x2="1028" y1="465.6172" y2="478.6172"/><line style="stroke:#181818;stroke-width:1.0;" x1="987" x2="1028" y1="478.6172" y2="478.6172"/><polygon fill="#181818" points="997,474.6172,987,478.6172,997,482.6172,993,478.6172" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="993" y="460.5513">6</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="120" x="1005" y="460.5513">Remember&#160;cookie</text><path d="M48,490.6172 L117,490.6172 L117,497.75 L107,507.75 L48,507.75 L48,490.6172 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="1671.5234" style="stroke:#000000;stroke-width:1.5;" width="1286" x="48" y="490.6172"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24" x="63" y="503.6841">alt</text><text fill="#000000" font-family="Courier" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="343" x="132" y="502.8276">[Recipient&#160;accepts&#160;to&#160;receive&#160;the&#160;directory&#160;tree]</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="48" x2="1334" y1="2053.8047" y2="2053.8047"/><text fill="#000000" font-family="Courier" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="343" x="53" y="2066.0151">[Recipient&#160;refuses&#160;to&#160;receive&#160;the&#160;directory&#160;tree]</text><line style="stroke:#181818;stroke-width:1.0;" x1="690" x2="700" y1="569.1484" y2="565.1484"/><line style="stroke:#181818;stroke-width:1.0;" x1="690" x2="700" y1="569.1484" y2="573.1484"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="689" x2="975" y1="569.1484" y2="569.1484"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="706" y="548.9497">7</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="104" x="718" y="533.8169">1000&#160;ACCEPTED</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="128" x="718" y="548.9497">Cookie:&#160;&lt;COOKIE&gt;</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="24" x="718" y="564.0825">...</text><polygon fill="#181818" points="342,594.2813,332,598.2813,342,602.2813,338,598.2813" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="336" x2="678" y1="598.2813" y2="598.2813"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="348" y="593.2153">8</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="136" x="360" y="593.2153">Get&#160;cookie&#160;record</text><line style="stroke:#181818;stroke-width:1.0;" x1="677" x2="667" y1="627.4141" y2="623.4141"/><line style="stroke:#181818;stroke-width:1.0;" x1="677" x2="667" y1="627.4141" y2="631.4141"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="331" x2="678" y1="627.4141" y2="627.4141"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="338" y="622.3481">9</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="104" x="350" y="622.3481">Cookie&#160;record</text><line style="stroke:#181818;stroke-width:1.0;" x1="689" x2="731" y1="656.5469" y2="656.5469"/><line style="stroke:#181818;stroke-width:1.0;" x1="731" x2="731" y1="656.5469" y2="669.5469"/><line style="stroke:#181818;stroke-width:1.0;" x1="690" x2="731" y1="669.5469" y2="669.5469"/><polygon fill="#181818" points="700,665.5469,690,669.5469,700,673.5469,696,669.5469" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="696" y="651.481">10</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="152" x="716" y="651.481">Check&#160;cookie&#160;expiry</text><path d="M649,681.5469 L734,681.5469 L734,688.6797 L724,698.6797 L649,698.6797 L649,681.5469 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="191.6016" style="stroke:#000000;stroke-width:1.5;" width="373" x="649" y="681.5469"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="40" x="664" y="694.6138">break</text><text fill="#000000" font-family="Courier" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="105" x="749" y="693.7573">[Faulty&#160;cookie]</text><path d="M668,712.6797 L737,712.6797 L737,719.8125 L727,729.8125 L668,729.8125 L668,712.6797 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="146.4688" style="stroke:#000000;stroke-width:1.5;" width="329" x="668" y="712.6797"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24" x="683" y="725.7466">alt</text><text fill="#000000" font-family="Courier" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="140" x="752" y="724.8901">[Cookie&#160;has&#160;expired]</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="668" x2="997" y1="795.0781" y2="795.0781"/><text fill="#000000" font-family="Courier" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="161" x="673" y="807.2886">[Cookie&#160;does&#160;not&#160;exist]</text><line style="stroke:#181818;stroke-width:1.0;" x1="974" x2="964" y1="776.0781" y2="772.0781"/><line style="stroke:#181818;stroke-width:1.0;" x1="974" x2="964" y1="776.0781" y2="780.0781"/><line style="stroke:#181818;stroke-width:1.0;" x1="689" x2="975" y1="776.0781" y2="776.0781"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="696" y="763.4458">11</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="152" x="716" y="755.8794">1002&#160;COOKIE&#160;EXPIRED</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="24" x="716" y="771.0122">...</text><line style="stroke:#181818;stroke-width:1.0;" x1="974" x2="964" y1="851.1484" y2="847.1484"/><line style="stroke:#181818;stroke-width:1.0;" x1="974" x2="964" y1="851.1484" y2="855.1484"/><line style="stroke:#181818;stroke-width:1.0;" x1="689" x2="975" y1="851.1484" y2="851.1484"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="696" y="838.5161">12</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="80" x="716" y="830.9497">74&#160;EBADMSG</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="24" x="716" y="846.0825">...</text><line style="stroke:#181818;stroke-width:1.0;" x1="332" x2="342" y1="908.2813" y2="904.2813"/><line style="stroke:#181818;stroke-width:1.0;" x1="332" x2="342" y1="908.2813" y2="912.2813"/><line style="stroke:#181818;stroke-width:1.0;" x1="331" x2="678" y1="908.2813" y2="908.2813"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="348" y="903.2153">13</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="216" x="368" y="903.2153">Mark&#160;cookie&#160;record&#160;as&#160;valid</text><line style="stroke:#181818;stroke-width:1.0;" x1="974" x2="964" y1="967.6797" y2="963.6797"/><line style="stroke:#181818;stroke-width:1.0;" x1="974" x2="964" y1="967.6797" y2="971.6797"/><line style="stroke:#181818;stroke-width:1.0;" x1="689" x2="975" y1="967.6797" y2="967.6797"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="696" y="947.481">14</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="32" x="716" y="932.3481">POLL</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="128" x="716" y="947.481">Cookie:&#160;&lt;COOKIE&gt;</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="24" x="716" y="962.6138">...</text><path d="M67,979.6797 L144,979.6797 L144,986.8125 L134,996.8125 L67,996.8125 L67,979.6797 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="1049.125" style="stroke:#000000;stroke-width:1.5;" width="1242" x="67" y="979.6797"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32" x="82" y="992.7466">loop</text><polygon fill="#181818" points="700,1054.2109,690,1058.2109,700,1062.2109,696,1058.2109" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="694" x2="975" y1="1058.2109" y2="1058.2109"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="706" y="1038.0122">15</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="104" x="726" y="1022.8794">PICK&#160;&lt;COOKIE&gt;</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="128" x="726" y="1038.0122">Cookie:&#160;&lt;COOKIE&gt;</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="24" x="726" y="1053.145">...</text><polygon fill="#181818" points="342,1083.3438,332,1087.3438,342,1091.3438,338,1087.3438" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="336" x2="678" y1="1087.3438" y2="1087.3438"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="348" y="1082.2778">16</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="136" x="368" y="1082.2778">Get&#160;cookie&#160;record</text><line style="stroke:#181818;stroke-width:1.0;" x1="677" x2="667" y1="1116.4766" y2="1112.4766"/><line style="stroke:#181818;stroke-width:1.0;" x1="677" x2="667" y1="1116.4766" y2="1120.4766"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="331" x2="678" y1="1116.4766" y2="1116.4766"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="338" y="1111.4106">17</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="104" x="358" y="1111.4106">Cookie&#160;record</text><line style="stroke:#181818;stroke-width:1.0;" x1="689" x2="731" y1="1145.6094" y2="1145.6094"/><line style="stroke:#181818;stroke-width:1.0;" x1="731" x2="731" y1="1145.6094" y2="1158.6094"/><line style="stroke:#181818;stroke-width:1.0;" x1="690" x2="731" y1="1158.6094" y2="1158.6094"/><polygon fill="#181818" points="700,1154.6094,690,1158.6094,700,1162.6094,696,1158.6094" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="696" y="1140.5435">18</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="256" x="716" y="1140.5435">Check&#160;cookie&#160;expiry&#160;and&#160;validity</text><path d="M224,1170.6094 L309,1170.6094 L309,1177.7422 L299,1187.7422 L224,1187.7422 L224,1170.6094 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="295.8047" style="stroke:#000000;stroke-width:1.5;" width="798" x="224" y="1170.6094"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="40" x="239" y="1183.6763">break</text><text fill="#000000" font-family="Courier" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="105" x="324" y="1182.8198">[Faulty&#160;cookie]</text><path d="M243,1201.7422 L312,1201.7422 L312,1208.875 L302,1218.875 L243,1218.875 L243,1201.7422 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="250.6719" style="stroke:#000000;stroke-width:1.5;" width="754" x="243" y="1201.7422"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24" x="258" y="1214.8091">alt</text><text fill="#000000" font-family="Courier" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="140" x="327" y="1213.9526">[Cookie&#160;has&#160;expired]</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="243" x2="997" y1="1284.1406" y2="1284.1406"/><text fill="#000000" font-family="Courier" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="133" x="248" y="1296.3511">[Cookie&#160;is&#160;invalid]</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="243" x2="997" y1="1388.3438" y2="1388.3438"/><text fill="#000000" font-family="Courier" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="161" x="248" y="1400.5542">[Cookie&#160;does&#160;not&#160;exist]</text><line style="stroke:#181818;stroke-width:1.0;" x1="974" x2="964" y1="1265.1406" y2="1261.1406"/><line style="stroke:#181818;stroke-width:1.0;" x1="974" x2="964" y1="1265.1406" y2="1269.1406"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="689" x2="975" y1="1265.1406" y2="1265.1406"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="696" y="1252.5083">19</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="152" x="716" y="1244.9419">1002&#160;COOKIE&#160;EXPIRED</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="24" x="716" y="1260.0747">...</text><line style="stroke:#181818;stroke-width:1.0;" x1="332" x2="342" y1="1325.0781" y2="1321.0781"/><line style="stroke:#181818;stroke-width:1.0;" x1="332" x2="342" y1="1325.0781" y2="1329.0781"/><line style="stroke:#181818;stroke-width:1.0;" x1="331" x2="678" y1="1325.0781" y2="1325.0781"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="348" y="1320.0122">20</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="224" x="368" y="1320.0122">Expire&#160;out&#160;the&#160;cookie&#160;record</text><line style="stroke:#181818;stroke-width:1.0;" x1="974" x2="964" y1="1369.3438" y2="1365.3438"/><line style="stroke:#181818;stroke-width:1.0;" x1="974" x2="964" y1="1369.3438" y2="1373.3438"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="689" x2="975" y1="1369.3438" y2="1369.3438"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="696" y="1356.7114">21</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="80" x="716" y="1349.145">74&#160;EBADMSG</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="24" x="716" y="1364.2778">...</text><line style="stroke:#181818;stroke-width:1.0;" x1="974" x2="964" y1="1444.4141" y2="1440.4141"/><line style="stroke:#181818;stroke-width:1.0;" x1="974" x2="964" y1="1444.4141" y2="1448.4141"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="689" x2="975" y1="1444.4141" y2="1444.4141"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="696" y="1431.7817">22</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="80" x="716" y="1424.2153">74&#160;EBADMSG</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="24" x="716" y="1439.3481">...</text><polygon fill="#181818" points="182,1497.5469,172,1501.5469,182,1505.5469,178,1501.5469" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="176" x2="678" y1="1501.5469" y2="1501.5469"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="188" y="1496.481">23</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="336" x="208" y="1496.481">Get&#160;node&#160;contents&#160;at&#160;path&#160;in&#160;cookie&#160;record</text><line style="stroke:#181818;stroke-width:1.0;" x1="677" x2="667" y1="1530.6797" y2="1526.6797"/><line style="stroke:#181818;stroke-width:1.0;" x1="677" x2="667" y1="1530.6797" y2="1534.6797"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="171" x2="678" y1="1530.6797" y2="1530.6797"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="178" y="1525.6138">24</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="104" x="198" y="1525.6138">Node&#160;contents</text><line style="stroke:#181818;stroke-width:1.0;" x1="689" x2="731" y1="1559.8125" y2="1559.8125"/><line style="stroke:#181818;stroke-width:1.0;" x1="731" x2="731" y1="1559.8125" y2="1572.8125"/><line style="stroke:#181818;stroke-width:1.0;" x1="690" x2="731" y1="1572.8125" y2="1572.8125"/><polygon fill="#181818" points="700,1568.8125,690,1572.8125,700,1576.8125,696,1572.8125" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="696" y="1554.7466">25</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="152" x="716" y="1554.7466">Determine&#160;next&#160;path</text><line style="stroke:#181818;stroke-width:1.0;" x1="689" x2="731" y1="1601.9453" y2="1601.9453"/><line style="stroke:#181818;stroke-width:1.0;" x1="731" x2="731" y1="1601.9453" y2="1614.9453"/><line style="stroke:#181818;stroke-width:1.0;" x1="690" x2="731" y1="1614.9453" y2="1614.9453"/><polygon fill="#181818" points="700,1610.9453,690,1614.9453,700,1618.9453,696,1614.9453" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="696" y="1596.8794">26</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="176" x="716" y="1596.8794">Calculate&#160;Eng&#160;checksum</text><path d="M243,1626.9453 L328,1626.9453 L328,1634.0781 L318,1644.0781 L243,1644.0781 L243,1626.9453 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="257.1953" style="stroke:#000000;stroke-width:1.5;" width="1041" x="243" y="1626.9453"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="40" x="258" y="1640.0122">break</text><text fill="#000000" font-family="Courier" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="105" x="343" y="1639.1558">[No&#160;nodes&#160;left]</text><line style="stroke:#181818;stroke-width:1.0;" x1="332" x2="342" y1="1675.2109" y2="1671.2109"/><line style="stroke:#181818;stroke-width:1.0;" x1="332" x2="342" y1="1675.2109" y2="1679.2109"/><line style="stroke:#181818;stroke-width:1.0;" x1="331" x2="678" y1="1675.2109" y2="1675.2109"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="348" y="1670.145">27</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="224" x="368" y="1670.145">Expire&#160;out&#160;the&#160;cookie&#160;record</text><line style="stroke:#181818;stroke-width:1.0;" x1="974" x2="964" y1="1749.7422" y2="1745.7422"/><line style="stroke:#181818;stroke-width:1.0;" x1="974" x2="964" y1="1749.7422" y2="1753.7422"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="689" x2="975" y1="1749.7422" y2="1749.7422"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="696" y="1721.9771">28</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="716" y="1699.2778">2000&#160;DONE</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="128" x="716" y="1714.4106">Cookie:&#160;&lt;COOKIE&gt;</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="160" x="716" y="1729.5435">Digest:&#160;&lt;ENG_DIGEST&gt;</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="24" x="716" y="1744.6763">...</text><line style="stroke:#181818;stroke-width:1.0;" x1="986" x2="1028" y1="1778.875" y2="1778.875"/><line style="stroke:#181818;stroke-width:1.0;" x1="1028" x2="1028" y1="1778.875" y2="1791.875"/><line style="stroke:#181818;stroke-width:1.0;" x1="987" x2="1028" y1="1791.875" y2="1791.875"/><polygon fill="#181818" points="997,1787.875,987,1791.875,997,1795.875,993,1791.875" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="993" y="1773.8091">29</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="104" x="1013" y="1773.8091">Forget&#160;cookie</text><line style="stroke:#181818;stroke-width:1.0;" x1="986" x2="1028" y1="1821.0078" y2="1821.0078"/><line style="stroke:#181818;stroke-width:1.0;" x1="1028" x2="1028" y1="1821.0078" y2="1834.0078"/><line style="stroke:#181818;stroke-width:1.0;" x1="987" x2="1028" y1="1834.0078" y2="1834.0078"/><polygon fill="#181818" points="997,1830.0078,987,1834.0078,997,1838.0078,993,1834.0078" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="993" y="1815.9419">30</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="192" x="1013" y="1815.9419">Calculate&#160;Chang&#160;checksum</text><line style="stroke:#181818;stroke-width:1.0;" x1="986" x2="1028" y1="1863.1406" y2="1863.1406"/><line style="stroke:#181818;stroke-width:1.0;" x1="1028" x2="1028" y1="1863.1406" y2="1876.1406"/><line style="stroke:#181818;stroke-width:1.0;" x1="987" x2="1028" y1="1876.1406" y2="1876.1406"/><polygon fill="#181818" points="997,1872.1406,987,1876.1406,997,1880.1406,993,1876.1406" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="993" y="1858.0747">31</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="248" x="1013" y="1858.0747">Compare&#160;Eng&#160;with&#160;Chang&#160;checksum</text><line style="stroke:#181818;stroke-width:1.0;" x1="332" x2="342" y1="1919.2734" y2="1915.2734"/><line style="stroke:#181818;stroke-width:1.0;" x1="332" x2="342" y1="1919.2734" y2="1923.2734"/><line style="stroke:#181818;stroke-width:1.0;" x1="331" x2="678" y1="1919.2734" y2="1919.2734"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="348" y="1914.2075">32</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="304" x="368" y="1914.2075">Update&#160;cookie&#160;record's&#160;next&#160;path&#160;field</text><line style="stroke:#181818;stroke-width:1.0;" x1="974" x2="964" y1="1978.6719" y2="1974.6719"/><line style="stroke:#181818;stroke-width:1.0;" x1="974" x2="964" y1="1978.6719" y2="1982.6719"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="689" x2="975" y1="1978.6719" y2="1978.6719"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="696" y="1958.4731">33</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="716" y="1943.3403">2001&#160;MORE</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="128" x="716" y="1958.4731">Cookie:&#160;&lt;COOKIE&gt;</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="24" x="716" y="1973.606">...</text><line style="stroke:#181818;stroke-width:1.0;" x1="986" x2="1028" y1="2007.8047" y2="2007.8047"/><line style="stroke:#181818;stroke-width:1.0;" x1="1028" x2="1028" y1="2007.8047" y2="2020.8047"/><line style="stroke:#181818;stroke-width:1.0;" x1="987" x2="1028" y1="2020.8047" y2="2020.8047"/><polygon fill="#181818" points="997,2016.8047,987,2020.8047,997,2024.8047,993,2020.8047" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="993" y="2002.7388">34</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="192" x="1013" y="2002.7388">Calculate&#160;Chang&#160;checksum</text><line style="stroke:#181818;stroke-width:1.0;" x1="690" x2="700" y1="2125.0078" y2="2121.0078"/><line style="stroke:#181818;stroke-width:1.0;" x1="690" x2="700" y1="2125.0078" y2="2129.0078"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="689" x2="975" y1="2125.0078" y2="2125.0078"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="706" y="2104.8091">35</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="104" x="726" y="2089.6763">1001&#160;DECLINED</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="128" x="726" y="2104.8091">Cookie:&#160;&lt;COOKIE&gt;</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="24" x="726" y="2119.9419">...</text><line style="stroke:#181818;stroke-width:1.0;" x1="332" x2="342" y1="2154.1406" y2="2150.1406"/><line style="stroke:#181818;stroke-width:1.0;" x1="332" x2="342" y1="2154.1406" y2="2158.1406"/><line style="stroke:#181818;stroke-width:1.0;" x1="331" x2="678" y1="2154.1406" y2="2154.1406"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="348" y="2149.0747">36</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="224" x="368" y="2149.0747">Expire&#160;out&#160;the&#160;cookie&#160;record</text><rect fill="#DDDDDD" height="629.2813" id="_legend" rx="7.5" ry="7.5" style="stroke:#000000;stroke-width:1.0;" width="538" x="55" y="2239.4375"/><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="480" x="60" y="2257.4326">1.&#160;&#160;Request&#160;to&#160;receive&#160;a&#160;directory&#160;tree&#160;rooted&#160;at&#160;&lt;DIR_NAME&gt;</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="432" x="60" y="2273.7295">2.&#160;&#160;Refuse&#160;to&#160;send&#160;the&#160;directory&#160;tree&#160;rooted&#160;at&#160;&lt;PATH&gt;</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="224" x="60" y="2290.0264">4.&#160;&#160;INSERT&#160;INTO&#160;cookie_table</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="328" x="124" y="2306.3232">(id,&#160;expire_at,&#160;is_valid,&#160;next_path,&#160;...)</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="464" x="124" y="2322.6201">VALUES&#160;(&lt;COOKIE&gt;,&#160;&lt;EXPIRE_DATETIME&gt;,&#160;0,&#160;&lt;NEXT_PATH&gt;,&#160;...);</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="456" x="60" y="2338.917">5.&#160;&#160;Request&#160;to&#160;send&#160;a&#160;directory&#160;tree&#160;rooted&#160;at&#160;&lt;DIR_NAME&gt;</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="320" x="60" y="2355.2139">7.&#160;&#160;Accept&#160;to&#160;receive&#160;the&#160;directory&#160;tree</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="160" x="60" y="2371.5107">8.&#160;&#160;SELECT&#160;expire_at</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="136" x="124" y="2387.8076">FROM&#160;cookie_table</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="160" x="124" y="2404.1045">WHERE&#160;id&#160;=&#160;&lt;COOKIE&gt;;</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="384" x="60" y="2420.4014">11.&#160;Tell&#160;that&#160;the&#160;cookie&#160;in&#160;request&#160;has&#160;expired.</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="288" x="60" y="2436.6982">12.&#160;Tell&#160;that&#160;the&#160;request&#160;is&#160;faulty.</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="184" x="60" y="2452.9951">13.&#160;UPDATE&#160;cookie_table</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="128" x="124" y="2469.292">SET&#160;is_valid&#160;=&#160;1</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="160" x="124" y="2485.5889">WHERE&#160;id&#160;=&#160;&lt;COOKIE&gt;;</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="496" x="60" y="2501.8857">14.&#160;Tell&#160;"you&#160;may&#160;request&#160;back&#160;to&#160;get&#160;the&#160;next&#160;available&#160;node"</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="136" x="60" y="2518.1826">15.&#160;Get&#160;next&#160;node</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="328" x="60" y="2534.4795">16.&#160;SELECT&#160;expire_at,&#160;is_valid,&#160;next_path</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="136" x="124" y="2550.7764">FROM&#160;cookie_table</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="160" x="124" y="2567.0732">WHERE&#160;id&#160;=&#160;&lt;COOKIE&gt;;</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="384" x="60" y="2583.3701">19.&#160;Tell&#160;that&#160;the&#160;cookie&#160;in&#160;request&#160;has&#160;expired.</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="184" x="60" y="2599.667">20.&#160;UPDATE&#160;cookie_table</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="288" x="124" y="2615.9639">SET&#160;expire_at&#160;=&#160;&lt;(current&#160;datetime)&gt;</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="160" x="124" y="2632.2607">WHERE&#160;id&#160;=&#160;&lt;COOKIE&gt;;</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="288" x="60" y="2648.5576">21.&#160;Tell&#160;that&#160;the&#160;request&#160;is&#160;faulty.</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="288" x="60" y="2664.8545">22.&#160;Tell&#160;that&#160;the&#160;request&#160;is&#160;faulty.</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="184" x="60" y="2681.1514">27.&#160;UPDATE&#160;cookie_table</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="288" x="124" y="2697.4482">SET&#160;expire_at&#160;=&#160;&lt;(current&#160;datetime)&gt;</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="160" x="124" y="2713.7451">WHERE&#160;id&#160;=&#160;&lt;COOKIE&gt;;</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="520" x="60" y="2730.042">28.&#160;Send&#160;node&#160;and&#160;Eng&#160;checksum,&#160;and&#160;tell&#160;"this&#160;is&#160;the&#160;last&#160;node."</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="184" x="60" y="2746.3389">32.&#160;UPDATE&#160;cookie_table</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="216" x="124" y="2762.6357">SET&#160;next_path&#160;=&#160;&lt;NEXT_PATH&gt;</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="160" x="124" y="2778.9326">WHERE&#160;id&#160;=&#160;&lt;COOKIE&gt;;</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="456" x="60" y="2795.2295">33.&#160;Send&#160;node&#160;and&#160;tell&#160;"there&#160;is&#160;at&#160;least&#160;one&#160;node&#160;left."</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="320" x="60" y="2811.5264">35.&#160;Refuse&#160;to&#160;receive&#160;the&#160;directory&#160;tree</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="184" x="60" y="2827.8232">36.&#160;UPDATE&#160;cookie_table</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="288" x="124" y="2844.1201">SET&#160;expire_at&#160;=&#160;&lt;(current&#160;datetime)&gt;</text><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="160" x="124" y="2860.417">WHERE&#160;id&#160;=&#160;&lt;COOKIE&gt;;</text><!--SRC=[rLTjJzj84Fw-lsAEBr044Gwqt54kKaWSY1eIb9YxVgWKBVQ4hB2zENlDbVlrDxj-pokWzgIhAfAiPsUUVUQPcVKlYuW_1XmKodz0HGco-4c42nxn008PIdSUoG2NdtWuuuclUZ9KGqwFEpA914QCAQ5y12VYOJp3g2iYT9MCNfm8aGLSXBD8cnyUnjxXuGOpHY6KSCM2XmhsPl7514CFevxmCNw95GPxm6F85YTrwuTPPdsLpCXnnVAgLxTSv7uhDYiMOwGV0aDbZ8fVR1-MCHRFbc2MwnF6UA9ac0GFcYWV7oacF4YbP00-pXIp6a3sVoKOAr0IY1CKpmWSl9mVIWCYH58gz80hkEpsnzDX-zPkiQRPF4jYr7jZxLlDSSlMkxPpqs9djAq_dDXZXpwS4RXIFWcSAlxW8uFitu7mZW2_ByZNbAiZ4F7qcVjwCSJlQhhWQdu4ZKRZGx7ZZ_RWtfx0mMLdDFhIjrj7S6b_lUkFxMctxTXE_rOldT3gqFxgJ0sKrCDdzh7EWZd9woWufvrjryL5ZRvL5jYlP3Yn1tR7AKzLGE-DHxVhQVZpnXxR83pu7V9pVMOMPSr1twSuX4O7I_U220b2Uemv2I4Dv3MOrLpUa9k964nLlP3HQGFkxpHNww5CRAV80i6nTc0yoqBklSW40lvIX7pWxfCcwn5JA3gVm9-vy7Ku2AM7UyoYb5oJWNcebvZrgR52u5fPl9lLtzx8QlDaDs45L1tgm4sYYEeIFAvGYG0_jBP3Qbglo5lpDSbjdlzqhAHmtT9Cje3J5pjy17UExbES14TcHHb1g3a1e_yQgi_ZDB-DFNRQt8snoBAENHRoTcYdfylGSY0OeKP2H_PH8v5XAa3J73Kaac7PuRQKz-cddyqluK_xD_LqLubdsfQF49eDaXhG2TD_Y-wVoo3UrjWPA-sFMvd32xYx7mooTlqjf1vPX8272FaJXKe_KtlohYcAjqm1nZBJu-DMgyHu0TR9YGLTkpFe3-tkXbZcqFaPpO_SMOdu6aECD2Sf_HMJLZ6DwLo9ogkQqCd8M-QIHhQ7gskLW1NiT_UJcyem-1PsZEkB8clvoh5jKd-nEf6o4nSHotbVJqmbwXW3rFEyEEa-S5ype_-McxYPIl4EtLQZb5IPj9n0kzEnxnoTbjM36TZBQT0KwwwzY-ByIprcfxPhHngAJRh1v05DXRreHkeoxPakM24iUrmXBWjUQV0r2TKLsuIK1qZJcUiM_HXpHvwaUWYb8cyYLfjymVaPs5Vjxktakj1-7Lkc_Lefh9NsBO-UwiJhkw0PZcyMULtbey5WemBsmPToGS3qnwPcqkzyMIc9_ucMpBGm90fL4PQrNLZMAuNrBcNfuHccULslXBJPW4ngjvZtzRibX2joVOtaNwrvQvtchVKTlpT9vM6cjKllXEJR379pEQ0hszPZqvjH_gMkcs7LtIer-ergLJTTL1W58ipkikOIkaPTt7SJN_kgNepAWpOpJGsbELISlg3zvobkwixV7GtjTPNQ5Ozqez1pR7WzxVQlxOcJrU-cQTMJqMDHnHkjIcuwSrvbP-C66T3hS4hbtu8olhIlmkhcbdc_yCeRGyRUVbmc4MO2_H_0fmMtex6zgVEzcPEowMQ5abMDBiNgxQ-uaxrl_bUlPRjwze_Mvdwj4QoVIn-fZNH6m-7Ofijr2cWVDf7fc0Ab8AmQiBnjhQ3u5m00]--></g></svg>